define(["require","jquery","angular"],function(e){var t=e("jquery"),n=e("angular");return function(e){e.directive("insertHtml",["$parse",function(e){return function(t,r,i){var s=e(i.insertHtml)(t);n.isArray(s)?s.length?r.html(s.join("")):r.html(i.insertHtml.replace(/^[^|]+\|\|(?=[^|]+$)/,"").replace(/^['"\s]+|['"\s]+$/g,"")):n.isString(s)&&r.html(s)}}]),e.directive("dragSetComponents",["$compile","componentTransclude",function(e,t){return{scope:{tree:"="},restrict:"A",link:function(e,n,r){t.set(n)}}}]),e.directive("component",["$compile",function(e){return{restrict:"A",link:function(t,n,r){var i=(r.component||"").replace(/([A-Z])/g,"-$1");if(!i)return;var s=e("<"+i+"></"+i+">")(t);n.append(s)}}}]),e.directive("saveContent",["contentAnalysis",function(e){return{scope:!0,restrict:"A",link:function(t,n,r){n.on("keyup keydown paste",function(e){if(e.keyCode===13)return!1;t.$apply(r.saveContent),e.stopPropagation()}),t.save=function(t,r){t[r]=e.run(n[0])}}}}]),e.directive("cmsEditable",["rangeTransferStation",function(e){return{restrict:"A",link:function(t,n,r){n.on("keyup mouseup",function(){e.set(n[0])})}}}]),e.directive("saveTree",function(){return function(e,r,i){r.on("click",function(){function o(e,t){var n=e.children;for(var r=0,i=n.length;r<i;r++)if(n[r].content){var s=n[r].content;n[r].content.tree&&(s.tree=[]),t.push(s),o(n[r],s.tree||s.component)}else o(n[r],t)}function u(e){if(n.isArray(e))return!!e.length;if(n.isObject(e)){delete e.$$hashKey;for(var t in e)return!1;return!0}}function a(e,t){if(n.isArray(e)){var r=[];for(var i=0,s=e.length;i<s;i++){var o=a(e[i],t);o&&r.push(o)}return r.length?r:!1}if(n.isObject(e)){var f={};delete e.$$hashKey;for(var l in e){var o=a(e[l],e.componentName||t);o&&(f[l]=o)}return!u(f)||t=="tableResponsive"?f:!1}return e}var r=t(i.saveTree)[0],s=[];o(r,s),e.tree=a(n.copy(s)),e.$apply(i.save)})}}),e.directive("selection",function(){return{restrict:"A",link:function(e,t,n){t.on("selectstrat",function(e){alert("aaa")})}}}),e.directive("ngUpload",function(){return{scope:{imgSrc:"=imgSrc"},restrict:"A",link:function(e,n,r){var i="id"+(new Date).getTime();n.prop("id",i);var s=t("#"+i);e.imgSrc=e.imgSrc||"../../resources/images/components/picture/img-empty.png",s.on("change",function(){var n=t(this).attr("data-fileType");e.imgSrc="../../resources/images/test.jpg",e.$apply();return;var r})}}})}});
